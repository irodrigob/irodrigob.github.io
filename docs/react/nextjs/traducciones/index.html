<!DOCTYPE html>
<html lang="en" dir=>

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Traducciones">
<meta name="theme-color" content="#FFFFFF"><meta property="og:title" content="Traducciones" />
<meta property="og:description" content="Traducciones" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://irodrigob.github.io/docs/react/nextjs/traducciones/" />
<meta property="article:modified_time" content="2020-08-31T18:38:15+02:00" />
<title>Traducciones | Navi-developer</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/book.min.e40449dffab36960ca7d6bac529d52d7ab9f9d230ffe5de1799e29cb61bc0cb7.css" integrity="sha256-5ARJ3/qzaWDKfWusUp1S16ufnSMP/l3heZ4py2G8DLc=">
<script defer src="/en.search.min.8ad8182a1c4d0e3816c3673b19e67f20bc49f2b33eb0fa4fda7a6899382e4bab.js" integrity="sha256-itgYKhxNDjgWw2c7GeZ/ILxJ8rM&#43;sPpP2npomTguS6s="></script>

<script defer src="/sw.min.74a8bb07f0bee86d6bb9a2750f073f14d93c7e4512f28860370cfd879e9719b4.js" integrity="sha256-dKi7B/C&#43;6G1ruaJ1Dwc/FNk8fkUS8ohgNwz9h56XGbQ="></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  
</head>

<body dir=>
  <input type="checkbox" class="hidden" id="menu-control" />
  <main class="container flex">
    <aside class="book-menu">
      
  <nav>
<h2 class="book-brand">
  <a href="/"><span>Navi-developer</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>











  



  
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/github/" class="collapsed ">Github</a>
  

          
  
  
  

  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/hugo/" class="">Hugo</a>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/hugo/publicar_web_github/" class="">Publicar Web Github</a>
  

        </li>
      
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/python/" class="collapsed ">Python</a>
  

          
  
  
  

  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/react/" class="collapsed ">React</a>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/react/nextjs/" class="collapsed ">NextJS</a>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/react/nextjs/traducciones/" class="active">Traducciones</a>
  

        </li>
      
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/react/nwb/" class="collapsed ">nwb</a>
  

          
  
  
  

  

        </li>
      
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/sap/" class="">SAP</a>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/sap/abap/" class="collapsed ">ABAP</a>
  

          
  
  
  

  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/sap/BW/" class="collapsed ">BW</a>
  

          
  
  
  

  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/sap/gateway/" class="collapsed ">Gateway</a>
  

          
  
  
  

  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/sap/ui5/" class="collapsed ">UI5</a>
  

          
  
  
  

  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/sap/ventas/" class="collapsed ">Ventas</a>
  

          
  
  
  

  

        </li>
      
    
  </ul>
  

        </li>
      
    
  </ul>
  











  
<ul>
  
  <li>
    <a href="https://github.com/irodrigob" target="_blank" rel="noopener">
        Github
      </a>
  </li>
  
</ul>






</nav>




  <script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script>


 
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Traducciones</strong>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
    <input type="checkbox" class="hidden" id="toc-control" />
    <aside class="hidden clearfix">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#introducción">Introducción</a></li>
    <li><a href="#instalación-y-configuración-del-next-i18n">Instalación y configuración del <em>Next-i18n</em></a>
      <ul>
        <li><a href="#instalación">Instalación</a></li>
        <li><a href="#configuración">Configuración</a></li>
        <li><a href="#funcionamiento">Funcionamiento</a>
          <ul>
            <li><a href="#archivos-locales">Archivos <em>locales</em></a></li>
            <li><a href="#usando-en-páginas-y-componentes">Usando en páginas y componentes</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#detectar-el-idioma">Detectar el idioma</a></li>
  </ul>
</nav>


    </aside>
  
 
      </header>

      
      
  <article class="markdown"><h1 id="introducción">
  Introducción
  <a class="anchor" href="#introducci%c3%b3n">#</a>
</h1>
<p>Por defecto ni React ni NextJS permite hacer textos multiidioma. Pero al ser un sistema abierto alguien se ha trabajado una serie de plug-in para conseguirlo. El objetivo es explicar como hacerlo.</p>
<p>Los pasos vamos a dividirlo en dos:</p>
<ol>
<li>Será la instalación, configuración y funcionamiento del <em>Next-i18n</em> para poder los textos multiidioma.</li>
<li>Detectar el idioma para pasarselo al Next-i18n.</li>
</ol>
<h1 id="instalación-y-configuración-del-next-i18n">
  Instalación y configuración del <em>Next-i18n</em>
  <a class="anchor" href="#instalaci%c3%b3n-y-configuraci%c3%b3n-del-next-i18n">#</a>
</h1>
<h2 id="instalación">
  Instalación
  <a class="anchor" href="#instalaci%c3%b3n">#</a>
</h2>
<p>Hay que instalar el paquete 
  <a href="https://github.com/isaachinman/next-i18next">next-i18next</a>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-tpl" data-lang="tpl">npm install next-i18next
</code></pre></div><h2 id="configuración">
  Configuración
  <a class="anchor" href="#configuraci%c3%b3n">#</a>
</h2>
<p><strong>Nota Aclaratoria:</strong> Pongo los datos en que me ha funcionado, ya que con el ejemplo que ponen en el paquete no funciona.</p>
<p>Hay que crear, si no lo esta, el fichero <em>next.config.js</em> en la carpeta ráiz del proyecto y añadir lo siguiente:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-tpl" data-lang="tpl">const <span style="color:#75715e">{</span> <span style="color:#a6e22e">nextI18NextRewrites</span> <span style="color:#75715e">}</span> = require(&#34;next-i18next/rewrites&#34;);

const localeSubpaths = <span style="color:#75715e">{}</span>;

module.exports = <span style="color:#75715e">{</span>
  <span style="color:#a6e22e">rewrites</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">async</span> <span style="color:#f92672">()</span> <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">nextI18NextRewrites</span><span style="color:#f92672">(</span><span style="color:#a6e22e">localeSubpaths</span><span style="color:#f92672">),</span>
  <span style="color:#a6e22e">publicRuntimeConfig</span><span style="color:#f92672">:</span> <span style="color:#75715e">{</span>
    <span style="color:#a6e22e">localeSubpaths</span><span style="color:#f92672">,</span>
  <span style="color:#75715e">}</span><span style="color:#f92672">,</span>
<span style="color:#75715e">}</span>;

Esto lo que hace es permitir los path por idioma a nivel de URL. 

En la carpeta raíz del proyecto hay que crear el archivo *i18n.js* y añadir lo siguiente:
```tpl
const NextI18Next = require(&#34;next-i18next&#34;).default;
const <span style="color:#75715e">{</span> <span style="color:#a6e22e">localeSubpaths</span> <span style="color:#75715e">}</span> = require(&#34;next/config&#34;).default().publicRuntimeConfig;
const path = require(&#34;path&#34;);

module.exports = new NextI18Next(<span style="color:#75715e">{</span>
  <span style="color:#a6e22e">defaultLanguage</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;es&#34;</span><span style="color:#f92672">,</span>
  <span style="color:#a6e22e">fallbackLng</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;es&#34;</span><span style="color:#f92672">,</span>
  <span style="color:#a6e22e">otherLanguages</span><span style="color:#f92672">:</span> <span style="color:#f92672">[</span><span style="color:#e6db74">&#34;en&#34;</span><span style="color:#f92672">],</span>
  <span style="color:#a6e22e">localeSubpaths</span><span style="color:#f92672">,</span>
  <span style="color:#a6e22e">localePath</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">path</span><span style="color:#f92672">.</span><span style="color:#a6e22e">resolve</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;./public/static/locales&#34;</span><span style="color:#f92672">),</span>
<span style="color:#75715e">}</span>);
</code></pre></div><p>Esto lo que hace es instanciar la clase <em>NextI18Next</em> que es la que se usará para las traducciones. Cosas a tener en cuenta:</p>
<ul>
<li>El parámetro <em>defaultLanguage</em> no me funciona. Me toma el idioma <em>en</em>. Pero con el parámetro <em>fallbackLng</em> soluciono el problema porque la carpeta <em>en</em> de los locales no esta creada, por lo tanto busca el idioma de dicho parámetro.</li>
<li>en el parámetro <em>localPath</em> se indica en que directorio hay que añadir los archivos de traducción. Luego se verá su formato.</li>
</ul>
<p>En la carpeta <em>pages</em> hay que modificar el archivo <em>_app.js</em>(en la últimas versiones de <em>NextJS</em> ya viene por defecto) y añadir lo siguiente:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-tpl" data-lang="tpl">import App from &#34;next/app&#34;;
import <span style="color:#75715e">{</span> <span style="color:#a6e22e">appWithTranslation</span> <span style="color:#75715e">}</span> from &#34;i18n&#34;;


const OCRApp = (<span style="color:#75715e">{</span> <span style="color:#a6e22e">Component</span><span style="color:#f92672">,</span> <span style="color:#a6e22e">pageProps</span> <span style="color:#75715e">}</span>) =&gt; <span style="color:#75715e">{</span>
  <span style="color:#a6e22e">return</span> <span style="color:#f92672">(</span>
      <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">Component</span> <span style="color:#75715e">{</span><span style="color:#f92672">...</span><span style="color:#a6e22e">pageProps</span><span style="color:#75715e">}</span> <span style="color:#f92672">/&gt;;</span>    
  <span style="color:#f92672">);</span>
<span style="color:#75715e">}</span>;

OCRApp.getInitialProps = async (appContext) =&gt; <span style="color:#75715e">{</span>
  <span style="color:#a6e22e">const</span> <span style="color:#a6e22e">appProps</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">App</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getInitialProps</span><span style="color:#f92672">(</span><span style="color:#a6e22e">appContext</span><span style="color:#f92672">);</span>
  <span style="color:#a6e22e">return</span> <span style="color:#75715e">{</span> <span style="color:#f92672">...</span><span style="color:#a6e22e">appProps</span> <span style="color:#75715e">}</span><span style="color:#f92672">;</span>
<span style="color:#75715e">}</span>;

export default appWithTranslation(OCRApp);
</code></pre></div><p>Este archivo es un poco distinto a lo que explican en el ejemplo del paquete, porque a declarar la aplicación <em>OCRApp</em> faltaba el <em>return</em>.</p>
<p>Aunque NextJS recomienda no usar el <em>getInitialProps</em>, hay que usarlo por necesidad ya que el paquete no funciona bien con los <em>getServerSideProps</em> o <em>getStaticProps</em>, no falla, pero da un warning en consola constantemente sobre que falta declarar el <em>namespacesRequired</em>. Cosa que no ocurre si se usa el <em>getInitialProps</em>.</p>
<h2 id="funcionamiento">
  Funcionamiento
  <a class="anchor" href="#funcionamiento">#</a>
</h2>
<h3 id="archivos-locales">
  Archivos <em>locales</em>
  <a class="anchor" href="#archivos-locales">#</a>
</h3>
<p>Dentro dela carpeta <em>public</em> del proyecto hay que crear la carpeta <em>locales</em>, dentro de ella el código del idioma y dentro de la carpeta del idioma el fichero <em>common.json</em>. Este fichero es que el que busca por defecto. La estructura en mi caso queda así:</p>
<pre><code>public
|--- locales
|    |--- es
|    |    |--- common.js
</code></pre><p>Ejemplo del fichero es el siguiente:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-tpl" data-lang="tpl"><span style="color:#75715e">{</span>
    <span style="color:#e6db74">&#34;AppTitle&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;OCR de Facturas&#34;</span><span style="color:#f92672">,</span>
    <span style="color:#e6db74">&#34;PageLoginTitle&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Datos de acceso&#34;</span><span style="color:#f92672">,</span>
    <span style="color:#e6db74">&#34;loginLblUsername&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Usuario&#34;</span><span style="color:#f92672">,</span>
    <span style="color:#e6db74">&#34;loginLblPassword&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Password&#34;</span>
<span style="color:#75715e">}</span>
</code></pre></div><p>El nombre del las etiquetas no puede tener ni &ldquo;.&rdquo; ni &ldquo;_&rdquo;, ni supongo que otros carácteres, ya que sino no funciona. Probado personalmente porque en <em>Open UI5</em> suelo usar el &ldquo;.&rdquo; para separar cada parte de la etiqueta.</p>
<p><strong>NOTA IMPORTANTE:</strong> Se pueden crear ficheros con otros nombres, pero el <em>common</em> es el que ira a buscar por defecto. Será en las páginas/componentes donde se indique el fichero que se quiere leer.
<strong>NOTA IMPORTANTE 2:</strong> Los cambios que se hagan en los ficheros de traducción implica tener que reiniciar el servidor para tomar los cambios.</p>
<h3 id="usando-en-páginas-y-componentes">
  Usando en páginas y componentes
  <a class="anchor" href="#usando-en-p%c3%a1ginas-y-componentes">#</a>
</h3>
<p>Un ejemplo de como usarlo en una página o componentes es el siguiente:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-tpl" data-lang="tpl">import PropTypes from &#34;prop-types&#34;;
import <span style="color:#75715e">{</span> <span style="color:#a6e22e">i18n</span><span style="color:#f92672">,</span> <span style="color:#a6e22e">Link</span><span style="color:#f92672">,</span> <span style="color:#a6e22e">withTranslation</span> <span style="color:#75715e">}</span> from &#34;i18n&#34;;

const login = (<span style="color:#75715e">{</span> <span style="color:#a6e22e">t</span> <span style="color:#75715e">}</span>) =&gt; <span style="color:#75715e">{</span>
  <span style="color:#a6e22e">return</span> <span style="color:#f92672">(</span>
    <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">div</span> <span style="color:#a6e22e">className</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;container&#34;</span><span style="color:#f92672">&gt;</span>
      <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">div</span> <span style="color:#a6e22e">className</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;jumbotron&#34;</span><span style="color:#f92672">&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">p</span> <span style="color:#a6e22e">className</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;lead text-center&#34;</span><span style="color:#f92672">&gt;</span><span style="color:#75715e">{</span><span style="color:#a6e22e">t</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;PageLoginTitle&#34;</span><span style="color:#f92672">)</span><span style="color:#75715e">}</span><span style="color:#f92672">&lt;/</span><span style="color:#a6e22e">p</span><span style="color:#f92672">&gt;</span>
       
      <span style="color:#f92672">&lt;/</span><span style="color:#a6e22e">div</span><span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;/</span><span style="color:#a6e22e">div</span><span style="color:#f92672">&gt;</span>
  <span style="color:#f92672">);</span>
<span style="color:#75715e">}</span>;

login.getInitialProps = async () =&gt; <span style="color:#75715e">{</span>
  <span style="color:#a6e22e">return</span> <span style="color:#75715e">{</span> <span style="color:#a6e22e">namespacesRequired</span><span style="color:#f92672">:</span> <span style="color:#f92672">[</span><span style="color:#e6db74">&#34;common&#34;</span><span style="color:#f92672">]</span> <span style="color:#75715e">}</span><span style="color:#f92672">;</span>
<span style="color:#75715e">}</span>;

login.propTypes = <span style="color:#75715e">{</span>
  <span style="color:#a6e22e">t</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">PropTypes</span><span style="color:#f92672">.</span><span style="color:#a6e22e">func</span><span style="color:#f92672">.</span><span style="color:#a6e22e">isRequired</span><span style="color:#f92672">,</span>
<span style="color:#75715e">}</span>;

export default withTranslation(&#34;common&#34;)(login);

</code></pre></div><p>Cosas a tener en cuenta:</p>
<ul>
<li>El <em>{t}</em> que son los parámetros de la vista siempre será <em>t</em> ya que es el que se pasa al hacer <em>withTranslation(&ldquo;common&rdquo;)(login)</em></li>
<li>El texto se recupera usando <em>{t(&ldquo;<nombre de la etiqueta>&rdquo;)}</em></li>
<li>El <em>namespacesRequired</em> se pone porque lo indica la 
  <a href="https://github.com/isaachinman/next-i18next#4-declaring-namespace-dependencies">docu oficial</a> para temas de rendimiento. Ya que sino se indica se lee todos los ficheros posibles, penalizando el rendimiento. Aun poniendolo me da el warning en la consola del servidor <em>NextJS</em>.</li>
</ul>
<p>Cosas que que no tengo claras:</p>
<ul>
<li>El <em>.propTypes</em> es una validación para que el parámetro <em>t</em> sea obligatorio. Pero tengo claro que sea necesarioa. Ya que poniendolo, como si no, funciona todo bien. Y parámetro o props <em>t</em> se tienen que poner si o si.</li>
</ul>
<h1 id="detectar-el-idioma">
  Detectar el idioma
  <a class="anchor" href="#detectar-el-idioma">#</a>
</h1>
<p>Hay que instalar el paquete: 
  <a href="https://github.com/i18next/i18next-browser-languageDetector">i18next-browser-languageDetector</a> mediante el siguiente comando:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-tpl" data-lang="tpl">npm install i18next-browser-languagedetector
</code></pre></div><p><strong>NOTA:NO SOY CAPAZ DE HACERLO FUNCIONAR DIRECTAMENTE CON NEXT-I18NEXT</strong> Encontrará soluciones alternativas.</p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>

 
        
      </footer>

      
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#introducción">Introducción</a></li>
    <li><a href="#instalación-y-configuración-del-next-i18n">Instalación y configuración del <em>Next-i18n</em></a>
      <ul>
        <li><a href="#instalación">Instalación</a></li>
        <li><a href="#configuración">Configuración</a></li>
        <li><a href="#funcionamiento">Funcionamiento</a>
          <ul>
            <li><a href="#archivos-locales">Archivos <em>locales</em></a></li>
            <li><a href="#usando-en-páginas-y-componentes">Usando en páginas y componentes</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#detectar-el-idioma">Detectar el idioma</a></li>
  </ul>
</nav>

 
    </aside>
    
  </main>

  
</body>

</html>












