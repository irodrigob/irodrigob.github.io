<!DOCTYPE html>
<html lang="en" dir=>

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Ejemplo sobre los estimadores de incertidumbre">
<meta name="theme-color" content="#FFFFFF"><meta property="og:title" content="Estimador incertidumbre" />
<meta property="og:description" content="Ejemplo sobre los estimadores de incertidumbre" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://irodrigob.github.io/docs/python/machine_learning/estimador_incertidumbre/" />

<title>Estimador incertidumbre | Navi-developer</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/book.min.e40449dffab36960ca7d6bac529d52d7ab9f9d230ffe5de1799e29cb61bc0cb7.css" integrity="sha256-5ARJ3/qzaWDKfWusUp1S16ufnSMP/l3heZ4py2G8DLc=">
<script defer src="/en.search.min.852a8e8639e16f893b851518fcc272ee732886df15585cfeeb96570a72b8afdd.js" integrity="sha256-hSqOhjnhb4k7hRUY/MJy7nMoht8VWFz&#43;65ZXCnK4r90="></script>

<script defer src="/sw.min.74a8bb07f0bee86d6bb9a2750f073f14d93c7e4512f28860370cfd879e9719b4.js" integrity="sha256-dKi7B/C&#43;6G1ruaJ1Dwc/FNk8fkUS8ohgNwz9h56XGbQ="></script>
<link rel="alternate" type="application/rss+xml" href="https://irodrigob.github.io/docs/python/machine_learning/estimador_incertidumbre/index.xml" title="Navi-developer" />
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  
</head>

<body dir=>
  <input type="checkbox" class="hidden" id="menu-control" />
  <main class="container flex">
    <aside class="book-menu">
      
  <nav>
<h2 class="book-brand">
  <a href="/"><span>Navi-developer</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>











  



  
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/github/" class="collapsed ">Github</a>
  

          
  
  
  

  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/graph_ql/" class="collapsed ">GraphQL</a>
  

          
  
  
  

  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/hugo/" class="">Hugo</a>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/hugo/publicar_web_github/" class="">Publicar Web Github</a>
  

        </li>
      
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/mongodb/" class="">MongoDB</a>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/mongodb/usando_app/" class="">MongoDB en aplicaciones</a>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/mongodb/usando_app/mongoose/" class="">Conector Mongoose</a>
  

        </li>
      
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/mongodb/cloud/" class="collapsed ">MongoDB en cloud</a>
  

          
  
  
  

  

        </li>
      
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/python/" class="collapsed ">Python</a>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/python/enlaces_interes/" class="">Enlaces de interes</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/python/entorno_desarrollo/" class="">Entorno de desarrollo</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/python/extensiones/" class="">Extensiones</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/python/framework/" class="collapsed ">Frameworks</a>
  

          
  
  
  

  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/python/anaconda/" class="">Anaconda</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/python/configuracion_pylint/" class="">Configuración Pylint</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/python/machine_learning/" class="collapsed ">Machine learning</a>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/python/machine_learning/librerias/" class="">Librerias y paquetes</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/python/machine_learning/algoritmo_aprendizaje_no_supervisado/" class="collapsed ">Algoritmos de aprendizaje no supervisado</a>
  

          
  
  
  

  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/python/machine_learning/arbol_decisiones/" class="collapsed ">Arbol de decisiones</a>
  

          
  
  
  

  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/python/machine_learning/estimador_incertidumbre/" class="collapsed active">Estimador incertidumbre</a>
  

          
  
  
  

  
  <ul>
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/python/machine_learning/guardar_modelos_entrenados/" class="">Guardar modelos entrenados</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/python/machine_learning/procesamiento_datos/" class="collapsed ">Procesamiento de datos</a>
  

          
  
  
  

  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/python/machine_learning/redes_neuronales/" class="collapsed ">Redes neuronales</a>
  

          
  
  
  

  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/python/machine_learning/regresion_lineal/" class="collapsed ">Regresion lineal</a>
  

          
  
  
  

  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/python/machine_learning/set_datos_propios/" class="collapsed ">Set de datos propios</a>
  

          
  
  
  

  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/python/machine_learning/tensorflow/" class="collapsed ">Tensor Flow</a>
  

          
  
  
  

  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/python/machine_learning/usar_gpu/" class="">Uso GPU</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/python/machine_learning/vectorizacion/" class="collapsed ">Vectorización</a>
  

          
  
  
  

  

        </li>
      
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/python/sentencias/" class="collapsed ">Sentencias</a>
  

          
  
  
  

  

        </li>
      
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/react/" class="collapsed ">React</a>
  

          
  
  
  

  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/sap/" class="">SAP</a>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/sap/abap/" class="collapsed ">ABAP</a>
  

          
  
  
  

  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/sap/BW/" class="collapsed ">BW</a>
  

          
  
  
  

  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/sap/gateway/" class="collapsed ">Gateway</a>
  

          
  
  
  

  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/sap/ui5/" class="collapsed ">UI5</a>
  

          
  
  
  

  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/sap/ventas/" class="collapsed ">Ventas</a>
  

          
  
  
  

  

        </li>
      
    
  </ul>
  

        </li>
      
    
  </ul>
  











  
<ul>
  
  <li>
    <a href="https://github.com/irodrigob" target="_blank" rel="noopener">
        Github
      </a>
  </li>
  
</ul>






</nav>




  <script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script>


 
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Estimador incertidumbre</strong>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
    <input type="checkbox" class="hidden" id="toc-control" />
    <aside class="hidden clearfix">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#introducción">Introducción</a></li>
    <li><a href="#codigo">Codigo</a></li>
  </ul>
</nav>


    </aside>
  
 
      </header>

      
      
  <article class="markdown"><h1 id="introducción">
  Introducción
  <a class="anchor" href="#introducci%c3%b3n">#</a>
</h1>
<p>Ejemplo extraído del video 
  <a href="https://www.youtube.com/watch?v=2A7Hz3RjhIY&amp;t">Machine Learning episodio 5. Estimador de incertidumbre</a>. Se pondrán imagens obtenidas del video para explicar mejor el funcionamiento tal como lo hace en el video.</p>
<p>El ejemplo esta creado el <em>Jupiter Notebool</em> y se irá poniendo el código de las distintas celdas</p>
<p>El estimador de incertidumbre es una función que viene incluida en algunos algoritmos de <em>Scikit learn(Sklearn)</em>, y nos ayuda a ver como de seguro esta nuestro algoritmo al clasificar un nuevo valor o punto, como lo llama en el video. El estimador es el paquete <em>SVM</em> dentro de la librería de Sklearn.</p>
<p>Ejemplo si tenemos un algoritmo que tiene que clasificar entre 0 y 1, el estimador nos va a decir que tan seguro se siente nuestro algoritmo para predicir que el nuevo valor lo va a clasificar al grupo 0 o al grupo 1.
Por ejemplo nos puede servir para detectar que si un nuevo punto el algorito nos dice que esta al 50% seguro que lo va a clasificar al grupo 0, podríamos llegar a la conclusión que preferimos que no haga la predicción. Porque podría ser igual de valido que se clasificará al grupo 1. Ya que el nuevo valor tiene las misma posibilidades de ir a un grupo como al otro.</p>
<p>El uso del SVM es útil para poder escoger el algoritmo que nos va mejor a la hora de clasificar. Lo que hay que tener en cuenta el sobreajuste, si un algoritmo esta muy seguro a la hora de clasificar puede ser que este sobreajustando por lo tanto habrá que tratar dicho ajuste.</p>
<h1 id="codigo">
  Codigo
  <a class="anchor" href="#codigo">#</a>
</h1>
<p>
  <a href="/docs/python/machine_learning/estimador_incertidumbre/estados_incertidumbres.ipynb">Código fuente descargable</a></p>
<p>El primer paso es siempre cargar las librerías.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-tpl" data-lang="tpl"># Set de datos
from sklearn.datasets import load_iris
# Separador de datos de entrenamiento y test 
from sklearn.model_selection import train_test_split
# Libreria de los estados de incertidumbre
from sklearn import svm
</code></pre></div><p>Datos para las pruebas</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-tpl" data-lang="tpl"># Carga del modelo de datos
iris=load_iris()
</code></pre></div><p>Generación de las variables con los datos</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-tpl" data-lang="tpl">X_ent, X_test, y_ent, y_test = train_test_split(iris.data, iris.target)
</code></pre></div><p>Variable para poder poner en marcha el SVM</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-tpl" data-lang="tpl"># Se crea la variable con el algoritmo SVM
algoritmo = svm.SVC(probability=True)
</code></pre></div><p>Paso habitual para entrenar el algoritmo</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-tpl" data-lang="tpl"># Entrenamiento del algoritmo
algoritmo.fit(X_ent, y_ent)
</code></pre></div><p>Se informo como se quiere que se comporte el SVM.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-tpl" data-lang="tpl">algoritmo.decision_function_shape = &#34;ovr&#34;
# decision_function nos va a devolver un numero que nos va a decir que 
# tan lejos esta el punto del hiperplano que clasifica.
# Al algoritmo se le pasa los valores de testing y que solo nos traiga 10 ejemplos.
algoritmo.decision_function(X_test)[:10]
</code></pre></div><p>En este trozo de código vamos a explicar como funciona el SVM tal como lo hace el video. Veamos el siguiente modelo de datos:</p>
<p>
  <img src="/images/python/machine_learning/estimador_incertidumbre/estimador_incertidumbre_datos.png" alt="Datos del estimador de incertidumbre" /></p>
<p>La línea verde o hiperplano nos separa los puntos azules de los rojos. Lo que queremos que devuelva el algoritmo sea el número más alto, ya que indicará que esta lo más alejado posible de la línea/hiperplano.
Si el algoritmo un número que esta sobre la línea no va a estar muy seguro de como clasificarlo, pero si el punto esta lo más lejano de la línea el algoritmo va a estar más seguro a la hora de clasificarlo.</p>
<p>El resultado que devuelve al ejecutar es el siguiente:</p>
<pre><code>array([[-0.20269857,  2.23688486,  0.84169686],
       [-0.21313057,  2.23268086,  0.88330921],
       [ 2.22580348,  1.15214418, -0.24872264],
       [ 2.23455235,  1.13095515, -0.25044655],
       [ 2.23313006,  1.13211798, -0.24964792],
       [ 2.2269661 ,  1.1259788 , -0.24423893],
       [-0.23439994,  1.08865842,  2.22247787],
       [-0.23387148,  1.18608119,  2.17366629],
       [ 2.22684708,  1.14267576, -0.24739233],
       [-0.21427536,  2.21884877,  0.96646885]])
</code></pre><p>Que significa, que el primer registro o dato lo va a clasificar en el segundo grupo porque es el número más alto, es decir, el más alejado al hiperplano. En el segundo datos también iría al segundo grupo, pero en el tercer dato lo clasificaría en el primer grupo.</p>
<p><strong>NOTA: Nos devuelve tres grupos la función porque en el set de datos de Iris soy hay tres tipos de flores para clasificar</strong></p>
<p>Se lanza otra función contra los datos de test para devuelve unos valores similares al código anterior pero a nivel de probalidad.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-tpl" data-lang="tpl"># Esta función nos va decir algo parecido al &#34;decision_function&#34; pero en el 
# ámbito de la probabilidad.
# Se le pasa los datos de testing y se le indica que solo procese los 10 primeros
algoritmo.predict_proba(X_test)[:10]
</code></pre></div><p>El resultado que devuelve al ejecutar es el siguiente:</p>
<pre><code>array([[0.01701662, 0.97626968, 0.0067137 ],
       [0.01130569, 0.97524721, 0.0134471 ],
       [0.95145127, 0.03609592, 0.01245281],
       [0.97121252, 0.01879533, 0.00999214],
       [0.96865943, 0.02079702, 0.01054356],
       [0.95443207, 0.03348436, 0.01208357],
       [0.00997134, 0.04291861, 0.94711005],
       [0.01111241, 0.46790436, 0.52098323],
       [0.95385933, 0.03421938, 0.0119213 ],
       [0.01653293, 0.95084668, 0.03262039]])
</code></pre><p>Aquí vemos que el primer dato lo va clasificar al segundo grupo con un 97% de probabilidades, lo mismo para el segundo datos. Pero para el tercer registro iría al primer grupo con un 95% de probabilidades.</p>
<p>Como se ve la clasificación es coherente con la función anterior.</p>
<p><strong>NOTA: La suma de los porcentajes de cada fila va ser del 100%</strong></p>
<p>Finalmente se lanza la función de predicción para ver como va a predecir el algoritmo.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-tpl" data-lang="tpl"># Con al función o algoritmo predict nos va a decir como va a predecir el algoritmo de clasificación
algoritmo.predict(X_test)[:10]
</code></pre></div><p>El resultado que devuelve al ejecutar es el siguiente:</p>
<pre><code>array([1, 1, 0, 0, 0, 0, 2, 2, 0, 1])
</code></pre><p>El resultado que devuelve coincide con los valores que nos han devuelto las funciones anteriores. Hay que recordar que los arrays empiezan por el índice 0, por lo tanto en el primer registro que vale &ldquo;1&rdquo; equivale al 97% que devuelve el <em>PREDICT_PROBA</em> y el &ldquo;2.23&rdquo; que devuelve la función <em>DECISION_FUNCTION</em></p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>

 
        
      </footer>

      
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#introducción">Introducción</a></li>
    <li><a href="#codigo">Codigo</a></li>
  </ul>
</nav>

 
    </aside>
    
  </main>

  
</body>

</html>












