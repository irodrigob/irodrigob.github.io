<!DOCTYPE html>
<html lang="en" dir=>

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Ejemplo de redes neuronales usando Sklearn">
<meta name="theme-color" content="#FFFFFF"><meta property="og:title" content="Ejemplo de redes neuronales" />
<meta property="og:description" content="Ejemplo de redes neuronales usando Sklearn" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://irodrigob.github.io/docs/python/machine_learning/redes_neuronales/ejemplo_sklearn/" />

<title>Ejemplo de redes neuronales | Navi-developer</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/book.min.e40449dffab36960ca7d6bac529d52d7ab9f9d230ffe5de1799e29cb61bc0cb7.css" integrity="sha256-5ARJ3/qzaWDKfWusUp1S16ufnSMP/l3heZ4py2G8DLc=">
<script defer src="/en.search.min.2e18413bd65b385e519508b247acc812700176cb5c783864bd92c99bfdaa918c.js" integrity="sha256-LhhBO9ZbOF5RlQiyR6zIEnABdstceDhkvZLJm/2qkYw="></script>

<script defer src="/sw.min.74a8bb07f0bee86d6bb9a2750f073f14d93c7e4512f28860370cfd879e9719b4.js" integrity="sha256-dKi7B/C&#43;6G1ruaJ1Dwc/FNk8fkUS8ohgNwz9h56XGbQ="></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  
</head>

<body dir=>
  <input type="checkbox" class="hidden" id="menu-control" />
  <main class="container flex">
    <aside class="book-menu">
      
  <nav>
<h2 class="book-brand">
  <a href="/"><span>Navi-developer</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>











  



  
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/github/" class="collapsed ">Github</a>
  

          
  
  
  

  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/hugo/" class="">Hugo</a>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/hugo/publicar_web_github/" class="">Publicar Web Github</a>
  

        </li>
      
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/python/" class="collapsed ">Python</a>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/python/enlaces_interes/" class="">Enlaces de interes</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/python/entorno_desarrollo/" class="">Entorno de desarrollo</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/python/sentencias/" class="collapsed ">Sentencias</a>
  

          
  
  
  

  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/python/machine_learning/" class="collapsed ">Machine learning</a>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/python/machine_learning/librerias/" class="">Librerias</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/python/machine_learning/anaconda/" class="">Anaconda</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/python/machine_learning/arbol_decisiones/" class="">Arbol de decisiones</a>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/python/machine_learning/arbol_decisiones/ejemplo_basico/" class="">Ejemplo básico</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/python/machine_learning/arbol_decisiones/explicacion_sobreajuste/" class="">Explicación sobreajuste</a>
  

        </li>
      
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/python/machine_learning/estimador_incertidumbre/" class="">Estimador incertidumbre</a>
  

          
  
  
  

  
  <ul>
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/python/machine_learning/redes_neuronales/" class="">Redes neuronales</a>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/python/machine_learning/redes_neuronales/ejemplo_sklearn/" class="active">Ejemplo de redes neuronales</a>
  

        </li>
      
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/python/machine_learning/regresion_lineal/" class="">Regresion lineal</a>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/python/machine_learning/regresion_lineal/entrenar_algoritmo/" class="">Entrenar algoritmo de regresion lineal</a>
  

        </li>
      
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/python/machine_learning/vectorizacion/" class="">Vectorización</a>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/python/machine_learning/vectorizacion/conversion_palabra_a_numeros/" class="">Ejemplo de conversión de palabras a números</a>
  

        </li>
      
    
  </ul>
  

        </li>
      
    
  </ul>
  

        </li>
      
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/sap/" class="">SAP</a>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/sap/abap/" class="collapsed ">ABAP</a>
  

          
  
  
  

  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/sap/gateway/" class="">Gateway</a>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/sap/gateway/informacion_general/" class="">Información general</a>
  

        </li>
      
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/sap/ui5/" class="collapsed ">UI5</a>
  

          
  
  
  

  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/sap/ventas/" class="">Ventas</a>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/sap/ventas/informacion_general/" class="">Información general</a>
  

        </li>
      
    
  </ul>
  

        </li>
      
    
  </ul>
  

        </li>
      
    
  </ul>
  











  
<ul>
  
  <li>
    <a href="https://github.com/irodrigob" target="_blank" rel="noopener">
        Github
      </a>
  </li>
  
</ul>






</nav>




  <script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script>


 
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Ejemplo de redes neuronales</strong>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
    <input type="checkbox" class="hidden" id="toc-control" />
    <aside class="hidden clearfix">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#introducción">Introducción</a></li>
    <li><a href="#código">Código</a></li>
  </ul>
</nav>


    </aside>
  
 
      </header>

      
      
  <article class="markdown"><h1 id="introducción">
  Introducción
  <a class="anchor" href="#introducci%c3%b3n">#</a>
</h1>
<p>Ejemplo extraído del video 
  <a href="https://www.youtube.com/watch?v=7wC9YDImpyY">Machine Learning episodio 6. Redes neuronales</a></p>
<p>El ejemplo esta creado el <em>Jupiter Notebool</em> y se irá poniendo el código de las distintas celdas.</p>
<p>En este ejemplo se usa la librería <em>Scikit learn(Sklearn)</em> que según el video no es lo mejor para ello. Hay que mejores como <em>TenserFlow</em> pero requiere de más conocimientos de algebra lineal.</p>
<p>En la siguiente imagen tenemos un ejemplo de diagrama de una red neuronal:</p>
<p>
  <img src="/images/python/machine_learning/redes_neuronales/diagrama_red_neuronal.png" alt="Diagrama red neuronal" /></p>
<p>En este diagrama tenemos cuatro capas de nodos interconectados entre ellos.</p>
<p>Los nodos de la izquierda del todo son los datos son los que se van a usar para alimentar el algortimo.</p>
<p>Las capas ocultas son aquellas capas que no son ni de entrada ni de salida. Se llaman así porque se no se saben muy bien lo que hacen, solo que se pasan información entre ellas para ir alterando los valores para obtener predicciones más acertadas en el futuro.</p>
<p>Las capas de salida son las que devolverán los datos del algoritmo. En el caso de los datos de prueba de <em>Iris</em>(clasificación de las flores) serían el tipo de flor a la que pertenece.</p>
<p>Cada nodo del diagrama tiene un peso y un valor que se lo irá pasando al resto de nodos. Por ejemplo si estamos en el primer nodo de la segunda capa (la de la capa oculta), este nodo va a recibir información de los cuatro nodo de entrada. La información que recibe se divide en dos: Por un lado el valor que es la <em>X</em>, de la formula de la imagen, y su peso que es la <em>W</em> al que se le multiplará a <em>X</em>. A ese valor, que indicará que tan importante es dicho valor, se le sumará <em>B</em>. <em>B</em> es el <em>bias</em>, o sesgo, en castellano. Esto indicará que tan propensa es el nodo a activarse, como una especie de interruptor.</p>
<p>En este ejemplo:</p>
<p>
  <img src="/images/python/machine_learning/redes_neuronales/formula_activacion_nodo.png" alt="Formula de activación" /></p>
<p>indica que <em>Y</em> se activará si el valor obtenido supera el <em>0,5</em>. Con los valores de la imagen el nodo no se activará y no enviará información a las siguientes capas.</p>
<p>Ahora si cambiamos los valores que recibe por los siguientes:

  <img src="/images/python/machine_learning/redes_neuronales/formula_activacion_nodo2.png" alt="Formula de activación 2" /></p>
<p>El nodo si que se va activar, y enviará información a la siguiente capa.</p>
<p>Volviendo al diagrama de la red. Lo que hace el algoritmo de entrenamiento es como sabe las respuestas que debe esta recibiendo es ir modificando los valores de <em>W</em> y <em>B</em> para que las últimas capas de salida se activen cuando sea necesario. De esta manera es como el algoritmo aprende.</p>
<h1 id="código">
  Código
  <a class="anchor" href="#c%c3%b3digo">#</a>
</h1>
<p>Librerias del proceso</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-tpl" data-lang="tpl">import sklearn 
# Set de datos
from sklearn.datasets import load_iris
# Separación de datos de entrenamiento y test
from sklearn.model_selection import train_test_split
# Clasificador de la red neuronal
from sklearn.neural_network import MLPClassifier
</code></pre></div><p>Datos para pasarle al clasificador</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-tpl" data-lang="tpl"># Carga de datos
iris = load_iris()
</code></pre></div><p>Características de los datos</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-tpl" data-lang="tpl"># Datos con las características
caract = iris.data
</code></pre></div><p>Etiquetas de los datos</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-tpl" data-lang="tpl"># Datos con las etiquetas
etiq = iris.target
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-tpl" data-lang="tpl"># Separación de los datos de test y entrenamiento
X_ent, X_test, y_ent, y_test = train_test_split(caract, etiq)
</code></pre></div><p>Creación de la red neuronal</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-tpl" data-lang="tpl"># Se asigna el model de la red neuronal
# max_iter indica que las veces en que los nodos se van a intercambiar información 
# para aprender solo va ocurrir 10 veces.
# hidden_layer_sizes indica que va una capa oculta que tendrá 10 nodos.
red = MLPClassifier(max_iter=10, hidden_layer_sizes=(10))
</code></pre></div><p>Entrenamiento</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-tpl" data-lang="tpl"># Se entra al algoritmo
red.fit(X_ent, y_ent)
</code></pre></div><p>Resultado</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-tpl" data-lang="tpl"># Resultado del entrenamiento
red.score(X_test,y_test)
</code></pre></div><p>En este ejemplo devuelve un 28% predicciones correctas, es un valor muy malo. Para mejorarlo se puede subir el valor de <em>MAX_ITER</em> a 100, con que el % de aprendizaje sube al 81%. Si aumentamos a 500 el valor de <em>MAX_ITER</em> el % sube al 97%.</p>
<p>Hay que tener en cuenta que el set de datos de Iris es pequeño y al aumentar el número de iteracciones no afecta mucho al tiempo total de calculo. Contra más datos se tenga y más iteracciones se hagan más tiempo consumaría el algoritmo de aprendizaje.</p>
<p>En <em>HIDDEN_LAYER_SIZES</em> se le puede pasar un valor de <em>10,10</em>. Esto quiere decir que habrá 10 capas ocultas y en cada una de ellas 10 nodos.</p>
<p>Hay que tener en cuenta que si el resultado del entrenamiento es del 100% es que muy posiblemente tenga un sobreajuste.</p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>

 
        
      </footer>

      
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#introducción">Introducción</a></li>
    <li><a href="#código">Código</a></li>
  </ul>
</nav>

 
    </aside>
    
  </main>

  
</body>

</html>












